<a href="#" (click)="goBack()">back</a>

{{selectedRow.NAME}}

<div class="row">
  <div class="col-lg-5">
    <ul>
      <li *ngFor="let field of fields">
        <div class="row field-row">
          <div class="col-lg-3 text-right">
            <label for="field_{{field}}" class="field-label">{{field}}</label>
          </div>
          <div class="col-lg-9">
            <input type="text" *ngIf="!checkIfBoolean(selectedRow[field]) && !checkIfDateField(field)" [maxlength]="100" class="field-value"
                   id="field_{{field}}" [disabled]="field=='id'" [(ngModel)]="selectedRow[field]">
            <input type="checkbox" *ngIf="checkIfBoolean(selectedRow[field])" id="field_{{field}}" [(ngModel)]="selectedRow[field]">
            <my-date-picker *ngIf="checkIfDateField(field)" [(ngModel)]="selectedRow[field]" [options]="myDatePickerOptions" (dateChanged)="onDateChanged($event)"></my-date-picker>

          </div>
        </div>
      </li>
    </ul>
  </div>
  <div class="col-lg-7 ">


    <div *ngIf="followups">
      <table class="table">
        <th>id</th>
        <th>description</th>
        <th>status</th>
        <th>due date</th>
        <th>create date</th>
        <tr>
          <td colspan="5">
            <form #followupForm="ngForm" (ngSubmit)="createFollowup(newFollowup);followupForm.reset();">
              <div class="col-lg-4">
                <textarea type="text" [(ngModel)]="newFollowup.description" required minlength="4" id="desc" name="desc" #desc="ngModel"></textarea>
                <div *ngIf="desc.errors && (desc.dirty || desc.touched)"
                     class="alert alert-danger">
                  <div [hidden]="!desc.errors.required">
                    Status is required
                  </div>
                  <div [hidden]="!desc.errors.minlength">
                    Name must be at least 4 characters long.
                  </div>
                </div>
              </div>
              <div class="col-lg-3">

                <select [(ngModel)]="newFollowup.status" name="status" id="status" #status="ngModel" required>
                  <option *ngFor="let status of statuses" [ngValue]="status">{{status.name}}</option>
                  <div *ngIf="status.errors && (status.dirty || status.touched)"
                       class="alert alert-danger">
                    <div [hidden]="!status.errors.required">
                      Status is required
                    </div>
                  </div>
                </select>
              </div>
              <div class="col-lg-3">
                <my-date-picker [(ngModel)]="newFollowup.dueDate" [options]="myDatePickerOptions" (dateChanged)="onDateChanged($event)"
                                required id="dueDate" name="dueDate" #dueDate="ngModel"></my-date-picker>
                <!--<input type="date" [(ngModel)]="newFollowup.dueDate" name="dueDate2">-->
              </div>
              <div class="col-lg-2">
                <button type="submit" class="btn btn-default" [disabled]="!followupForm.form.valid">Submit</button>
              </div>
              <!--<td class="col-lg-2"><input type="submit" (click)="createFollowup(newFollowup)"></td>-->
            </form>
          </td>
        </tr>
        <tr *ngFor="let followup of selectedRow.followups | orderBy:'dueDate':false">
          <td>{{followup.id}}</td>
          <td class="col-lg-3">{{followup.description}}</td>
          <td class="col-lg-2">{{followup.status.name}}</td>
          <td class="col-lg-3">{{followup.dueDate | date:"dd-MM-yyyy"}}</td>
          <td class="col-lg-2">{{followup.createDate | date:"dd-MM-yyyy"}}</td>
        </tr>
      </table>
    </div>
  </div>

</div>

<div>
  <input type="button" class="btn" value="Save" (click)="save()">
  <input type="button" class="link" value="Cancel" (click)="goBack()">
</div>

